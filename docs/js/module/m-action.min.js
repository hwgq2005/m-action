!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Action=n()}(this,function(){"use strict";function e(e,n){for(var t in n)e[t]=n[t];return e}function n(e,n){return e.className.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))}function t(e,t){n(e,t)||(e.className+=" "+t)}function o(e,t){if(n(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ")}}var c=1050,i=function(n){var t={id:"modal"+(new Date).getTime(),actions:[],backdrop:!0,cancelButton:!0,cancelText:"取消",complete:function(){},cancel:function(){}},n=e(t,n);this.options=n,this.cancel=n.cancel,this.complete=n.complete,this.element=document.querySelectorAll("#"+n.id),this.init(this.options,this.element)};return i.prototype.init=function(e,n){var t=this;n.length<=0&&(c++,t.show(e,n))},i.prototype.show=function(){var e=this,n=e.options,o="",i=document.createElement("div");i.id=n.id,i.className="action ",i.style.zIndex=c-1,o+='<div class="action-menu">',n.summary?o+='<div class="action-summary">'+n.summary+"</div>":"",n.actions instanceof Array&&(o+='<ul class="action-list">',n.actions.forEach(function(e,n){o+='<li class="action-btn">'+e.name+"</li>"}),o+="</ul>"),n.cancelButton&&(o+='<ul><li  class="action-cancel-'+n.id+'">'+n.cancelText+"</li></ul>"),o+="</div>",i.innerHTML=o,document.body.appendChild(i),setTimeout(function(){t(i,"in")},10),"function"==typeof e.complete&&e.complete(),n.backdrop?e.backdrop(n):"",e.bindEvent(n)},i.prototype.hide=function(e){var n=this,t=e||this.options.id,c=document.querySelector("#"+t);o(c,"in"),setTimeout(function(){document.body.removeChild(c),document.querySelectorAll(".action-backdrop-"+t).length>0?n.hideBackDrop(t):""},200)},i.prototype.backdrop=function(e){var n=e.id;if(document.querySelectorAll(".action-backdrop-"+n).length<=0){var o=document.createElement("div");o.className="action-backdrop action-backdrop-"+n,o.style.zIndex=c-2,document.body.appendChild(o),t(document.body,"action-open"),setTimeout(function(){t(o,"in")},0)}},i.prototype.hideBackDrop=function(e){var n=document.querySelector(".action-backdrop-"+e);document.body.removeChild(n),document.querySelectorAll(".action-backdrop").length<1&&o(document.body,"action-open")},i.prototype.bindEvent=function(e){var n=this,t=e.id,o=document.querySelectorAll(".action-btn");o.length>0&&o.forEach(function(c,i){o[i].onclick=function(){"function"==typeof n.cancel&&(e.actions[i].callback(),n.hide(t))}});var c=document.querySelectorAll(".action-cancel-"+t);c.length>0&&(c[0].onclick=function(){"function"==typeof n.cancel&&(n.cancel(),n.hide(t))});var i=document.querySelectorAll(".action-close-"+t),a=document.querySelectorAll(".action-backdrop-"+t);i.length>0&&(i[0].onclick=function(){n.hide(t)}),a.length>0&&(a[0].onclick=function(){n.hide(t)},a[0].ontouchmove=function(e){e.preventDefault()})},function(e){new i(e)}});